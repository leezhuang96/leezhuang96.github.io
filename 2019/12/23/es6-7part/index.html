<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:site_name" content="Jordon&#39;s Blog">
    <meta property="og:type" content="article">

    
    <meta property="og:image" content="https://leezhuang96.github.io/img/home-bg-jeep.jpg">
    <meta property="twitter:image" content="https://leezhuang96.github.io/img/home-bg-jeep.jpg" />
    

    
    <meta name="title" content="ECMAScript 6（七）" />
    <meta property="og:title" content="ECMAScript 6（七）" />
    <meta property="twitter:title" content="ECMAScript 6（七）" />
    

    
    <meta name="description" content="ECMAScript 6.0（以下简称 ES6）是 JavaScript 语言的下一代标准，已经在 2015 年 6 月正式发布了。它的目标，是使得 JavaScript 语言可以用来编写复杂的大型应用程序，成为企业级开发语言。">
    <meta property="og:description" content="ECMAScript 6.0（以下简称 ES6）是 JavaScript 语言的下一代标准，已经在 2015 年 6 月正式发布了。它的目标，是使得 JavaScript 语言可以用来编写复杂的大型应用程序，成为企业级开发语言。" />
    <meta property="twitter:description" content="ECMAScript 6.0（以下简称 ES6）是 JavaScript 语言的下一代标准，已经在 2015 年 6 月正式发布了。它的目标，是使得 JavaScript 语言可以用来编写复杂的大型应用程序，成为企业级开发语言。" />
    

    
    <meta property="twitter:card" content="summary" />
    
    

    <meta name="keyword"  content="李状, Jordon, lizhuang, , 李状的网络日志, 李状的博客, Jordon&#39;s Blog, 博客, 个人网站, 互联网, Web, 云原生, PaaS, Istio, Kubernetes, 微服务, Microservice">
    <link rel="shortcut icon" href="/img/Blog.png">

    <title>ECMAScript 6（七）-李状的博客 | Jordon&#39;s Blog</title>

    <link rel="canonical" href="/2019/12/23/es6-7part/">

    <link rel="stylesheet" href="/css/iDisqus.min.css"/>
	
    
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    
    <link rel="stylesheet" href="/css/syntax.css">
    
    
    <link rel="stylesheet" href="/css/zanshang.css">
    
    
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    
    

    
    
    <script src="/js/jquery.min.js"></script>
    
    
    <script src="/js/bootstrap.min.js"></script>
    
    
    <script src="/js/hux-blog.min.js"></script>

    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/docco.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    
    

</head>



<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Jordon&#39;s Blog</a>
        </div>

        
        
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                    <li>
                        <a href="/categories/books">books</a>
                    </li>
                    
                    <li>
                        <a href="/categories/csharp">csharp</a>
                    </li>
                    
                    <li>
                        <a href="/categories/database">database</a>
                    </li>
                    
                    <li>
                        <a href="/categories/java">java</a>
                    </li>
                    
                    <li>
                        <a href="/categories/life">life</a>
                    </li>
                    
                    <li>
                        <a href="/categories/tech">tech</a>
                    </li>
                    
                    <li>
                        <a href="/categories/tips">tips</a>
                    </li>
                    
                    <li>
                        <a href="/categories/web">web</a>
                    </li>
                    
                    
		    
                        <li><a href="/top/about/">ABOUT</a></li>
                    

                    
                </ul>
            </div>
        </div>
        
    </div>
    
</nav>
<script>
    
    
    
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        
            $navbar.className = " ";
            
            setTimeout(function(){
                
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>




<style type="text/css">
    header.intro-header {
        background-image: url('https://img.zhaohuabing.com/in-post/2018-06-04-introducing-the-istio-v1alpha3-routing-api/background.jpg')
    }
</style>
<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/es6" title="ES6">
                            ES6
                        </a>
                        
                    </div>
                    <h1>ECMAScript 6（七）</h1>
                    <h2 class="subheading">Proxy &amp; Reflect</h2>
                    <span class="meta">
                        Posted by 
                        
                                &#34;Jordon Li&#34;
                         
                        on 
                        Monday, December 23, 2019
                        
                        
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>




<article>
    <div class="container">
        <div class="row">

            
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                
                <header>
                    <h2>TOC</h2>
                </header>
                <nav id="TableOfContents">
  <ul>
    <li><a href="#ecmascript-6-">ECMAScript 6 简介</a></li>
    <li><a href="#proxy">Proxy</a>
      <ul>
        <li><a href="#proxy-1">Proxy</a></li>
        <li><a href="#proxyrevocable">Proxy.revocable()</a></li>
        <li><a href="#handler">实例方法(支持的拦截handler)</a></li>
        <li><a href="#this-">this 问题</a></li>
      </ul>
    </li>
    <li><a href="#reflect">Reflect</a>
      <ul>
        <li><a href="#reflect-1">Reflect</a></li>
        <li><a href="#heading">静态方法</a></li>
      </ul>
    </li>
  </ul>
</nav>
                
                <h2 id="ecmascript-6-">ECMAScript 6 简介</h2>
<p>ECMAScript 6.0（以下简称 ES6）是 JavaScript 语言的下一代标准，已经在 2015 年 6 月正式发布了。它的目标，是使得 JavaScript 语言可以用来编写复杂的大型应用程序，成为企业级开发语言。</p>
<h2 id="proxy">Proxy</h2>
<h3 id="proxy-1">Proxy</h3>
<ul>
<li>基本用法：
<code>Proxy</code> 用于修改某些操作的默认行为，等同于在语言层面做出修改，所以属于一种“元编程”（meta programming），即对编程语言进行编程。
<code>Proxy</code> 可以理解成，在目标对象之前架设一层“拦截”，外界对该对象的访问，都必须先通过这层拦截，因此提供了一种机制，可以对外界的访问进行过滤和改写。
<pre><code>//Proxy 构造函数
var proxy = new Proxy(target, handler);
</code></pre></li>
</ul>
<p><code>target</code>参数表示所要拦截的目标对象，<code>handler</code>参数也是一个对象，用来定制拦截行为。</p>
<pre><code>//example
var obj = new Proxy({}, {
  get: function (target, propKey, receiver) {
    console.log(`getting ${propKey}!`);
    return Reflect.get(target, propKey, receiver);
  },
  set: function (target, propKey, value, receiver) {
    console.log(`setting ${propKey}!`);
    return Reflect.set(target, propKey, value, receiver);
  }
});
</code></pre><h3 id="proxyrevocable">Proxy.revocable()</h3>
<ul>
<li>基本用法：
<code>Proxy.revocable</code>方法返回一个可取消的 <code>Proxy</code> 实例。
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml">let target = {};
let handler = {};

let {proxy, revoke} = Proxy.revocable(target, handler);

proxy.foo = <span style="color:#ae81ff">123</span>;
proxy.foo 
// <span style="color:#ae81ff">123</span>

revoke(); //取消Proxy实例
proxy.foo 
// TypeError: Revoked
</code></pre></div></li>
</ul>
<h3 id="handler">实例方法(支持的拦截handler)</h3>
<h4 id="gettarget-propkey-receiver">get(target, propKey, receiver)</h4>
<ul>
<li>基本用法：
<code>get</code>方法用于拦截某个属性的读取操作，可以接受三个参数: 目标对象(<code>target</code>)、属性名(<code>propKey</code>)和 <code>proxy</code> 实例本身（严格地说，是操作行为所针对的对象）(<code>receiver</code>可选)。
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml">var person = {
  name: <span style="color:#e6db74">&#34;张三&#34;</span>
};

var proxy = new Proxy(person, {
  get: function(target, propKey) {
    if (propKey in target) {
      return target[propKey];
    } else {
      throw new ReferenceError(<span style="color:#e6db74">&#34;Prop name \&#34;&#34;</span> + propKey + <span style="color:#e6db74">&#34;\&#34; does not exist.&#34;</span>);
    }
  }
});

proxy.name // <span style="color:#e6db74">&#34;张三&#34;</span>
proxy.age // 抛出一个错误
</code></pre></div></li>
</ul>
<h4 id="settarget-propkey-value-receiver">set(target, propKey, value, receiver)</h4>
<ul>
<li>基本用法：
<code>set</code>方法用来拦截某个属性的赋值操作，可以接受四个参数: 目标对象(<code>target</code>)、属性名(<code>propKey</code>)、属性值(<code>value</code>)和 <code>Proxy</code> 实例本身(<code>receiver</code>可选)。
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml">let validator = {
  set: function(obj, prop, value) {
    if (prop === <span style="color:#e6db74">&#39;age&#39;</span>) {
      if (!Number.isInteger(value)) {
        throw new TypeError(<span style="color:#e6db74">&#39;The age is not an integer&#39;</span>);
      }
      if (value &gt; <span style="color:#ae81ff">200</span>) {
        throw new RangeError(<span style="color:#e6db74">&#39;The age seems invalid&#39;</span>);
      }
    }

    // 对于满足条件的 age 属性以及其他属性，直接保存
    obj[prop] = value;
  }
};

let person = new Proxy({}, validator);
</code></pre></div></li>
</ul>
<h4 id="applytarget-object-args">apply(target, object, args)</h4>
<ul>
<li>基本用法：
<code>apply</code>方法拦截函数的调用(<code>invoke</code>)、<code>call</code>和<code>apply</code>操作,可以接受三个参数: 目标对象(<code>target</code>)、目标对象的上下文对象(<code>this</code>)和目标对象的参数数组(<code>args</code>)。
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml">  var twice = {
    apply (target, ctx, args) {
      return Reflect.apply(...arguments) * <span style="color:#ae81ff">2</span>;
    }
  };
  function sum (left, right) {
    return left + right;
  };
  var proxy = new Proxy(sum, twice);
  proxy(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>) // <span style="color:#ae81ff">6</span>
  proxy.call(<span style="color:#66d9ef">null</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>) // <span style="color:#ae81ff">22</span>
  proxy.apply(<span style="color:#66d9ef">null</span>, [<span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>]) // <span style="color:#ae81ff">30</span>
</code></pre></div></li>
</ul>
<h4 id="hastarget-propkey">has(target, propKey)</h4>
<ul>
<li>基本用法：
<code>has</code>方法用来拦截<code>HasProperty</code>操作，即判断对象是否具有某个属性时，这个方法会生效。典型的操作就是<code>in</code>运算符。<code>has</code>方法可以接受两个参数: 目标对象(<code>target</code>)、需查询的属性名(<code>propKey</code>)。
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml">var handler = {
  has (target, key) {
    if (key[<span style="color:#ae81ff">0</span>] === <span style="color:#e6db74">&#39;_&#39;</span>) {
      return <span style="color:#66d9ef">false</span>;
    }
    return key in target;
  }
};
var target = { _prop: <span style="color:#e6db74">&#39;foo&#39;</span>, prop: <span style="color:#e6db74">&#39;foo&#39;</span> };
var proxy = new Proxy(target, handler);
<span style="color:#e6db74">&#39;_prop&#39;</span> in proxy // <span style="color:#66d9ef">false</span>
</code></pre></div><p>值得注意的是，<code>has</code>方法拦截的是<code>HasProperty</code>操作，而不是<code>HasOwnProperty</code>操作，即<code>has</code>方法不判断一个属性是对象自身的属性，还是继承的属性。</p>
</li>
</ul>
<h4 id="constructtarget-args">construct(target, args)</h4>
<ul>
<li>基本用法：
construct方法用于拦截new命令,可以接受两个参数: 目标对象(<code>target</code>)、构造函数的参数对象(<code>args</code>)。
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml">var p = new Proxy(function () {}, {
  construct: function(target, args) {
    console.log(<span style="color:#e6db74">&#39;called: &#39;</span> + args.join(<span style="color:#e6db74">&#39;, &#39;</span>));
    return { value: args[<span style="color:#ae81ff">0</span>] * <span style="color:#ae81ff">10</span> };
  }
});

(new p(<span style="color:#ae81ff">1</span>)).value
// <span style="color:#e6db74">&#34;called: 1&#34;</span>
// <span style="color:#ae81ff">10</span>

//construct方法返回的必须是一个对象，否则会报错。
var p = new Proxy(function() {}, {
  construct: function(target, argumentsList) {
    return <span style="color:#ae81ff">1</span>;
  }
});

new p() // 报错
</code></pre></div></li>
</ul>
<h4 id="deletepropertytarget-propkey">deleteProperty(target, propKey)</h4>
<ul>
<li>基本用法：
<code>deleteProperty</code>方法用于拦截<code>delete</code>操作，如果这个方法抛出错误或者返回<code>false</code>，当前属性就无法被<code>delete</code>命令删除。
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml">var handler = {
  deleteProperty (target, key) {
    invariant(key, <span style="color:#e6db74">&#39;delete&#39;</span>);
    delete target[key];
    return <span style="color:#66d9ef">true</span>;
  }
};
function invariant (key, action) {
  if (key[<span style="color:#ae81ff">0</span>] === <span style="color:#e6db74">&#39;_&#39;</span>) {
    throw new Error(`Invalid attempt to ${action} private <span style="color:#e6db74">&#34;${key}&#34;</span> property`);
  }
}

var target = { _prop: <span style="color:#e6db74">&#39;foo&#39;</span> };
var proxy = new Proxy(target, handler);
delete proxy._prop
// Error: Invalid attempt to delete private <span style="color:#e6db74">&#34;_prop&#34;</span> property
</code></pre></div></li>
</ul>
<h4 id="definepropertytarget-propkey-propdesc">defineProperty(target, propKey, propDesc)</h4>
<ul>
<li>基本用法：
<code>defineProperty</code>方法拦截了<code>Object.defineProperty</code>操作。
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml">var handler = {
  defineProperty (target, key, descriptor) {
    return <span style="color:#66d9ef">false</span>;
  }
};
var target = {};
var proxy = new Proxy(target, handler);
proxy.foo = <span style="color:#e6db74">&#39;bar&#39;</span> // 不会生效
</code></pre></div></li>
</ul>
<h4 id="getownpropertydescriptortarget-propkey">getOwnPropertyDescriptor(target, propKey)</h4>
<ul>
<li>基本用法：
<code>getOwnPropertyDescriptor</code>方法拦截<code>Object.getOwnPropertyDescriptor()</code>，返回一个属性描述对象或者<code>undefined</code>。
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml">var handler = {
  getOwnPropertyDescriptor (target, key) {
    if (key[<span style="color:#ae81ff">0</span>] === <span style="color:#e6db74">&#39;_&#39;</span>) {
      return;
    }
    return Object.getOwnPropertyDescriptor(target, key);
  }
};
var target = { _foo: <span style="color:#e6db74">&#39;bar&#39;</span>, baz: <span style="color:#e6db74">&#39;tar&#39;</span> };
var proxy = new Proxy(target, handler);
Object.getOwnPropertyDescriptor(proxy, <span style="color:#e6db74">&#39;wat&#39;</span>)
// undefined
Object.getOwnPropertyDescriptor(proxy, <span style="color:#e6db74">&#39;_foo&#39;</span>)
// undefined
Object.getOwnPropertyDescriptor(proxy, <span style="color:#e6db74">&#39;baz&#39;</span>)
// { value: <span style="color:#e6db74">&#39;tar&#39;</span>, writable: <span style="color:#66d9ef">true</span>, enumerable: <span style="color:#66d9ef">true</span>, configurable: <span style="color:#66d9ef">true</span> }
</code></pre></div></li>
</ul>
<h4 id="getprototypeoftarget">getPrototypeOf(target)</h4>
<ul>
<li>基本用法：
<code>getPrototypeOf</code>方法主要用来拦截获取对象原型。具体来说，拦截下面这些操作:
<ul>
<li>Object.prototype.<strong>proto</strong></li>
<li>Object.prototype.isPrototypeOf()</li>
<li>Object.getPrototypeOf()</li>
<li>Reflect.getPrototypeOf()</li>
<li>instanceof
注意，<code>getPrototypeOf</code>方法的返回值必须是对象或者<code>null</code>，否则报错。</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml">var proto = {};
var p = new Proxy({}, {
  getPrototypeOf(target) {
    return proto;
  }
});
Object.getPrototypeOf(p) === proto // <span style="color:#66d9ef">true</span>
</code></pre></div></li>
</ul>
<h4 id="isextensibletarget">isExtensible(target)</h4>
<ul>
<li>基本用法：
<code>isExtensible</code>方法拦截<code>Object.isExtensible</code>操作。注意，该方法只能返回布尔值，否则返回值会被自动转为布尔值。
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml">var p = new Proxy({}, {
  isExtensible: function(target) {
    console.log(<span style="color:#e6db74">&#34;called&#34;</span>);
    return <span style="color:#66d9ef">true</span>;
  }
});

Object.isExtensible(p)
// <span style="color:#e6db74">&#34;called&#34;</span>
// <span style="color:#66d9ef">true</span>
</code></pre></div></li>
</ul>
<h4 id="ownkeystarget">ownKeys(target)</h4>
<ul>
<li>基本用法：
<code>ownKeys</code>方法用来拦截对象自身属性的读取操作。具体来说，拦截以下操作:
<ul>
<li>Object.getOwnPropertyNames()</li>
<li>Object.getOwnPropertySymbols()</li>
<li>Object.keys()</li>
<li>for&hellip;in循环</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml">var p = new Proxy({}, {
  ownKeys: function(target) {
    return [<span style="color:#e6db74">&#39;a&#39;</span>, <span style="color:#e6db74">&#39;b&#39;</span>, <span style="color:#e6db74">&#39;c&#39;</span>];
  }
});

Object.getOwnPropertyNames(p)
// [ <span style="color:#e6db74">&#39;a&#39;</span>, <span style="color:#e6db74">&#39;b&#39;</span>, <span style="color:#e6db74">&#39;c&#39;</span> ]
</code></pre></div></li>
</ul>
<h4 id="preventextensionstarget">preventExtensions(target)</h4>
<ul>
<li>基本用法：
<code>preventExtensions</code>方法拦截<code>Object.preventExtensions()</code>。该方法必须返回一个布尔值，否则会被自动转为布尔值。这个方法有一个限制，只有目标对象不可扩展时（即<code>Object.isExtensible(proxy)</code>为<code>false</code>），<code>proxy.preventExtensions</code>才能返回<code>true</code>，否则会报错。为了防止出现这个问题，通常要在<code>proxy.preventExtensions</code>方法里面，调用一次<code>Object.preventExtensions</code>。
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml">var proxy = new Proxy({}, {
  preventExtensions: function(target) {
    console.log(<span style="color:#e6db74">&#39;called&#39;</span>);
    Object.preventExtensions(target);
    return <span style="color:#66d9ef">true</span>;
  }
});

Object.preventExtensions(proxy)
// <span style="color:#e6db74">&#34;called&#34;</span>
// Proxy {}
</code></pre></div></li>
</ul>
<h4 id="setprototypeoftarget-proto">setPrototypeOf(target, proto)</h4>
<ul>
<li>基本用法：
<code>setPrototypeOf</code>方法主要用来拦截<code>Object.setPrototypeOf</code>方法。
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml">var handler = {
  setPrototypeOf (target, proto) {
    throw new Error(<span style="color:#e6db74">&#39;Changing the prototype is forbidden&#39;</span>);
  }
};
var proto = {};
var target = function () {};
var proxy = new Proxy(target, handler);
Object.setPrototypeOf(proxy, proto);
// Error: Changing the prototype is forbidden
</code></pre></div></li>
</ul>
<h3 id="this-">this 问题</h3>
<ul>
<li>基本用法：
虽然 <code>Proxy</code> 可以代理针对目标对象的访问，但它不是目标对象的透明代理，即不做任何拦截的情况下，也无法保证与目标对象的行为一致。主要原因就是在 <code>Proxy</code> 代理的情况下，目标对象内部的<code>this</code>关键字会指向 <code>Proxy</code> 代理。
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml">const target = {
  m: function () {
    console.log(this === proxy);
  }
};
const handler = {};

const proxy = new Proxy(target, handler);

target.m() // <span style="color:#66d9ef">false</span>
proxy.m()  // <span style="color:#66d9ef">true</span>
</code></pre></div></li>
</ul>
<h2 id="reflect">Reflect</h2>
<h3 id="reflect-1">Reflect</h3>
<ul>
<li>基本用法：
<code>Reflect</code>对象与<code>Proxy</code>对象一样，也是 ES6 为了操作对象而提供的新<code>API</code>。<code>Reflect</code>对象的设计目的有这样几个:
<ul>
<li>将<code>Object</code>对象的一些明显属于语言内部的方法（比如<code>Object.defineProperty</code>），放到<code>Reflect</code>对象上。现阶段，某些方法同时在<code>Object</code>和<code>Reflect</code>对象上部署，未来的新方法将只部署在<code>Reflect</code>对象上。也就是说，从<code>Reflect</code>对象上可以拿到语言内部的方法。</li>
<li>修改某些<code>Object</code>方法的返回结果，让其变得更合理。</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml">//比如，Object.defineProperty(obj, name, desc)在无法定义属性时，会抛出一个错误，
//而Reflect.defineProperty(obj, name, desc)则会返回false。
// 老写法
try {
  Object.defineProperty(target, property, attributes);
  // success
} catch (e) {
  // failure
}

// 新写法
if (Reflect.defineProperty(target, property, attributes)) {
  // success
} else {
  // failure
}
</code></pre></div><ul>
<li>让<code>Object</code>操作都变成函数行为。</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml">//某些Object操作是命令式，比如name in obj和delete obj[name]，
//而Reflect.has(obj, name)和Reflect.deleteProperty(obj, name)让它们变成了函数行为。
// 老写法
<span style="color:#e6db74">&#39;assign&#39;</span> in Object // <span style="color:#66d9ef">true</span>

// 新写法
Reflect.has(Object, <span style="color:#e6db74">&#39;assign&#39;</span>) // <span style="color:#66d9ef">true</span>
</code></pre></div><ul>
<li><code>Reflect</code>对象的方法与<code>Proxy</code>对象的方法一一对应，只要是<code>Proxy</code>对象的方法，就能在<code>Reflect</code>对象上找到对应的方法。这就让<code>Proxy</code>对象可以方便地调用对应的<code>Reflect</code>方法，完成默认行为，作为修改行为的基础。也就是说，不管<code>Proxy</code>怎么修改默认行为，你总可以在<code>Reflect</code>上获取默认行为。</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml">Proxy(target, {
  set: function(target, name, value, receiver) {
    var success = Reflect.set(target, name, value, receiver); //完成默认行为
    //制定拦截行为
    if (success) {
      console.log(<span style="color:#e6db74">&#39;property &#39;</span> + name + <span style="color:#e6db74">&#39; on &#39;</span> + target + <span style="color:#e6db74">&#39; set to &#39;</span> + value);
    }
    return success;
  }
});
</code></pre></div></li>
</ul>
<h3 id="heading">静态方法</h3>
<p><code>Reflect</code>对象一共有 13 个静态方法,大部分与<code>Object</code>对象的同名方法的作用都是相同的，而且它与<code>Proxy</code>对象的方法是一一对应的:</p>
<ul>
<li>Reflect.apply(target, thisArg, args)</li>
<li>Reflect.construct(target, args)</li>
<li>Reflect.get(target, name, receiver)</li>
<li>Reflect.set(target, name, value, receiver)</li>
<li>Reflect.defineProperty(target, name, desc)</li>
<li>Reflect.deleteProperty(target, name)</li>
<li>Reflect.has(target, name)</li>
<li>Reflect.ownKeys(target)</li>
<li>Reflect.isExtensible(target)</li>
<li>Reflect.preventExtensions(target)</li>
<li>Reflect.getOwnPropertyDescriptor(target, name)</li>
<li>Reflect.getPrototypeOf(target)</li>
<li>Reflect.setPrototypeOf(target, prototype)</li>
</ul>

                
                
<div class="entry-shang text-center">
    
	    <p> 「下次一定」</p>
	
	<button class="zs show-zs btn btn-bred">赞赏支持</button>
</div>
<div class="zs-modal-bg"></div>
<div class="zs-modal-box">
	<div class="zs-modal-head">
		<button type="button" class="close">×</button>
		<span class="author">
			
				<img src="/img/favicon.png" />
				
			
		</span>
        
	        <p class="tip"><i></i><span>下次一定</span></p>
		
 
	</div>
	<div class="zs-modal-body">
		<div class="zs-modal-btns">
			<button class="btn btn-blink" data-num="2">2元</button>
			<button class="btn btn-blink" data-num="5">5元</button>
			<button class="btn btn-blink" data-num="10">10元</button>
			<button class="btn btn-blink" data-num="50">50元</button>
			<button class="btn btn-blink" data-num="100">100元</button>
			<button class="btn btn-blink" data-num="1">任意金额</button>
		</div>
		<div class="zs-modal-pay">
			<button class="btn btn-bred" id="pay-text">任意金额</button>
			<p>使用<span id="pay-type">微信</span>扫描二维码完成支付</p>
			<img src="/img/reward/wechat.png"  id="pay-image"/>
		</div>
	</div>
	<div class="zs-modal-footer">
		<label>
			<input type="radio" name="zs-type" value="wechat" class="zs-type" checked="checked">
			<img src="/img/reward/wechat-btn.png"/>
		</label>
		<label>
			<input type="radio" name="zs-type" value="alipay" class="zs-type" class="zs-alipay">
			<img src="/img/reward/alipay-btn.png"/>
		</label>
	</div>
</div>
<script type="text/javascript" src="/js/reward.js"></script>

                

                <hr>
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2019/12/23/es6-8part/" data-toggle="tooltip" data-placement="top" title="ECMAScript 6（八）">&larr;
                            Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2019/12/25/es6-10part/" data-toggle="tooltip" data-placement="top" title="ECMAScript 6（十）">Next
                            Post &rarr;</a>
                    </li>
                    
                </ul>

                
<div id="disqus-comment"></div>



            </div>
            
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/csharp" title="csharp">
                            csharp
                        </a>
                        
                        
                        
                        <a href="/tags/docker" title="docker">
                            docker
                        </a>
                        
                        
                        
                        <a href="/tags/dot-net-core" title="dot-net-core">
                            dot-net-core
                        </a>
                        
                        
                        
                        <a href="/tags/es6" title="es6">
                            es6
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/istio" title="istio">
                            istio
                        </a>
                        
                        
                        
                        <a href="/tags/japanese" title="japanese">
                            japanese
                        </a>
                        
                        
                        
                        <a href="/tags/kubernetes" title="kubernetes">
                            kubernetes
                        </a>
                        
                        
                        
                        <a href="/tags/microservice" title="microservice">
                            microservice
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/security" title="security">
                            security
                        </a>
                        
                        
                        
                        <a href="/tags/service-mesh" title="service-mesh">
                            service-mesh
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/tips" title="tips">
                            tips
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/vue" title="vue">
                            vue
                        </a>
                        
                        
                        
                        
                        
                        
                    </div>
                </section>
                

                
                
            </div>
        </div>
    </div>
</article>




<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                   
                    
                    <li>
                        <a href="mailto:leezhuang96@gmail.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    
                    

                    

		    
                    
                    <li>
                        <a target="_blank" href="/img/wechat_qrcode.jpg">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-wechat fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    <li>
                        <a target="_blank" href="https://github.com/leezhuang96">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    
                    
                    
                    
                    
                    
                </ul>
		<p class="copyright text-muted">
                    Copyright &copy; Jordon&#39;s Blog 2020
                    <br>
                    <a href="https://themes.gohugo.io/hugo-theme-cleanwhite">CleanWhite Hugo Theme</a> by <a href="https://zhaohuabing.com">Huabing</a> |
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="100px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>




<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>






<script>
    
    if($('#tag_cloud').length !== 0){
        async("/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>


<script>
    async("https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>



<script>
    (function(){
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https'){
       bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
      }
      else{
      bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>



<script>
    
    var _baId = 'leezhuang96';

    
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?" + _baId;
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
</script>




</body>
</html>
